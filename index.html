<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>è™›æ“¬å…¬å¸å„€è¡¨æ¿</title>
  <style>
    :root {
      color-scheme: light;
    }
    body {
      font-family: "Noto Sans TC", "Segoe UI", sans-serif;
      margin: 0;
      padding: 2rem;
      background: #f5f7fb;
      color: #1c1f23;
    }
    h1 { margin-top: 0; }
    section {
      background: #fff;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 4px 12px rgba(15, 23, 42, 0.08);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      border: 1px solid #e2e8f0;
      padding: 0.75rem;
      text-align: left;
      vertical-align: top;
    }
    th { background: #edf2ff; font-weight: 600; }
    .legend span { display: inline-block; margin-right: 1rem; }
    .card-grid {
      display: grid;
      gap: 1rem;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      margin-top: 1rem;
    }
    .staff-card {
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      padding: 1rem;
      background: #fff;
      box-shadow: 0 2px 8px rgba(15, 23, 42, 0.06);
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .staff-card h3 { margin: 0; font-size: 1.15rem; }
    .badge { display: inline-block; padding: 0.15rem 0.5rem; border-radius: 999px; font-size: 0.8rem; color: #fff; }
    .badge-green { background: #22c55e; }
    .badge-yellow { background: #facc15; color:#1f2937; }
    .badge-gray { background: #94a3b8; }
    .progress-log { font-size: 0.9rem; color: #475569; }
    .input-stack { display: flex; flex-direction: column; gap: 0.4rem; }
    textarea, input[type="text"], select {
      width: 100%; border-radius: 8px; border: 1px solid #cbd5f5; padding: 0.65rem;
      font-family: inherit; font-size: 0.95rem; background: #f8fafc;
    }
    .mini-btn {
      align-self: flex-start; padding: 0.45rem 0.8rem; border-radius: 6px;
      border: none; background: #3b82f6; color: #fff; font-size: 0.85rem; cursor: pointer;
    }
    .mini-btn:hover { background: #2563eb; }
    .progress-bar { width: 100%; height: 6px; background: #e2e8f0; border-radius: 999px; overflow: hidden; }
    .progress-bar span { display:block; height:100%; background: linear-gradient(90deg,#3b82f6,#0ea5e9); }
    #global-log { max-height: 360px; overflow-y: auto; border:1px solid #e2e8f0; border-radius:12px; padding:1rem; background:#fdfdfd; }
    .chat-entry { margin-bottom:1rem; padding-bottom:0.5rem; border-bottom:1px solid #e7edf6; }
    .chat-entry:last-child { border-bottom:none; }
  </style>
</head>
<body>
  <h1>è™›æ“¬å…¬å¸å„€è¡¨æ¿</h1>
  <p><em>æœ€å¾Œæ›´æ–°ï¼š2026-02-20 04:05 UTC</em></p>

  <section>
    <h2>ç¸½è¦½</h2>
    <ul>
      <li><strong>å…¬å¸ä½¿å‘½ï¼š</strong> æ‰“é€ é«˜ç«¯ç´‹ç¹¡ / ç¾å®¹æœå‹™ï¼Œè¼¸å‡ºè¡ŒéŠ· know-howï¼Œä¸¦ä»¥è‡ªå‹•åŒ– BTC ç­–ç•¥å¢å€¼è³‡é‡‘ã€‚</li>
      <li><strong>éƒ¨é–€ï¼š</strong>
        <ol>
          <li>ç¾å®¹ï¼ˆç´‹ç¹¡ï¼‰éƒ¨é–€ â€” 5 ä½è™›æ“¬å¤¥ä¼´</li>
          <li>ç¶²è·¯è¡ŒéŠ·ä»£æ“éƒ¨é–€ â€” 2 ä½è™›æ“¬å¤¥ä¼´</li>
          <li>ç¾é‡‘æµ / BTC äº¤æ˜“éƒ¨é–€ â€” 1 ä½è™›æ“¬å¤¥ä¼´</li>
        </ol>
      </li>
    </ul>
    <p class="legend"><strong>ç‹€æ…‹åœ–ä¾‹ï¼š</strong>
      <span>ğŸŸ¢ é€²è¡Œä¸­</span>
      <span>ğŸŸ¡ æ–½å·¥ä¸­</span>
      <span>âšª å¾…å•Ÿå‹•</span>
    </p>
  </section>

  <section>
    <h2>äº¤è¾¦ / å›è¦†ç‹€æ…‹å¡</h2>
    <div class="card-grid" id="staff-cards"></div>
    <p style="font-size:0.85rem;color:#94a3b8;margin-top:0.8rem;">ï¼Šäº¤è«‡ç´€éŒ„æš«å­˜æ–¼æœ¬æ©Ÿç€è¦½å™¨ LocalStorageï¼Œåƒ…æ­¤è£ç½®å¯è¦‹ã€‚</p>
  </section>

  <section>
    <h2>åœ˜é«”æœƒè­°å³æ™‚å°è©±</h2>
    <div class="input-stack" style="max-width:600px;">
      <label>é¸æ“‡å°è±¡ï¼ˆå¯é¸éƒ¨é–€æˆ–å–®ä¸€æˆå“¡ï¼‰ï¼š</label>
      <select id="global-target"></select>
      <textarea id="global-message" placeholder="è¼¸å…¥æœƒè­°æŒ‡ç¤ºæˆ–ç´€éŒ„"></textarea>
      <button class="mini-btn" id="global-send">æ–°å¢åˆ°å°è©±æ¡†</button>
    </div>
    <div id="global-log" style="margin-top:1rem;"></div>
  </section>

  <section>
    <h2>è·¨éƒ¨é–€å”ä½œ</h2>
    <ol>
      <li><strong>ç¾å®¹ â†’ è¡ŒéŠ·ä»£æ“ï¼š</strong> Iris èˆ‡ Victor å…±ç·¨ã€ŒPMU Insightsã€ã€‚</li>
      <li><strong>è¡ŒéŠ·ä»£æ“ â†’ ç¾å®¹ï¼š</strong> Ada æ¯é€±äº”åˆ†äº« META æŠ•æ”¾æ´å¯Ÿã€‚</li>
      <li><strong>BTC â†’ ç¸½éƒ¨ï¼š</strong> Noah åœ¨ Telegram åŒ¯å ±æç›Š / åœå–® / é‡å•Ÿå»ºè­°ã€‚</li>
    </ol>
  </section>

  <section>
    <h2>å³æœŸé‡Œç¨‹ç¢‘</h2>
    <table>
      <tr>
        <th>æ—¥æœŸ (UTC)</th>
        <th>é …ç›®</th>
        <th>è² è²¬äºº</th>
        <th>å‚™è¨»</th>
      </tr>
      <tr>
        <td>2/21</td>
        <td>ç¾å®¹é ç´„å®˜ç¶² Soft Launch</td>
        <td>Leo + Mia</td>
        <td>Evan æä¾›å½±ç‰‡ç´ æ</td>
      </tr>
      <tr>
        <td>2/22</td>
        <td>è¡ŒéŠ·ä»£æ“æ¡ˆä¾‹ç°¡å ±</td>
        <td>Victor</td>
        <td>å¼•ç”¨ç¾å®¹éƒ¨é–€ KPI</td>
      </tr>
      <tr>
        <td>2/23</td>
        <td>BTC æ¨¡æ“¬ç³»çµ± Demo</td>
        <td>Noah</td>
        <td>å–æ±ºæ–¼è³‡æ–™ç®¡ç·šé€²åº¦</td>
      </tr>
    </table>
  </section>

  <script>
    const staffList = [
      { id: 'B-01', name: 'é™³èŠ®çµ² Iris', title: 'å¸‚å ´æƒ…å ±é•·', dept: 'ç¾å®¹', baseStatus: 'ğŸŸ¢ é€²è¡Œä¸­' },
      { id: 'B-02', name: 'å³æ´› Leo', title: 'æ•¸ä½ä½ˆå±€æ¶æ§‹å¸«', dept: 'ç¾å®¹', baseStatus: 'ğŸŸ¡ æ–½å·¥ä¸­' },
      { id: 'B-03', name: 'å”ç±³äº Mia', title: 'å…§å®¹èˆ‡æ–‡æ¡ˆç­–åŠƒ', dept: 'ç¾å®¹', baseStatus: 'ğŸŸ¢ é€²è¡Œä¸­' },
      { id: 'B-04', name: 'æ—å¥•å‡¡ Evan', title: 'å½±åƒè£½ä½œäºº', dept: 'ç¾å®¹', baseStatus: 'ğŸŸ¡ æ–½å·¥ä¸­' },
      { id: 'B-05', name: 'é«˜æ›¸å¦ƒ Sophie', title: 'ç‡Ÿé‹èˆ‡äººæ‰ Lead', dept: 'ç¾å®¹', baseStatus: 'âšª å¾…å•Ÿå‹•' },
      { id: 'M-01', name: 'é»ƒç¶­å…‹ Victor', title: 'ç”¢æ¥­ç­–ç•¥é¡§å•', dept: 'ç¶²è·¯è¡ŒéŠ·ä»£æ“', baseStatus: 'ğŸŸ¢ é€²è¡Œä¸­' },
      { id: 'M-02', name: 'ç¾…é›…é” Ada', title: 'META å»£å‘Šè¦åŠƒ', dept: 'ç¶²è·¯è¡ŒéŠ·ä»£æ“', baseStatus: 'ğŸŸ¡ æ–½å·¥ä¸­' },
      { id: 'C-01', name: 'æ›¾è«¾äº Noah', title: 'é‡åŒ–ç‡Ÿé‹èˆ‡é¢¨æ§', dept: 'ç¾é‡‘æµ / BTC', baseStatus: 'ğŸŸ¡ æ–½å·¥ä¸­' },
    ];

    const cardsRoot = document.getElementById('staff-cards');

    staffList.forEach(staff => {
      const card = document.createElement('div');
      card.className = 'staff-card';
      card.dataset.staffId = staff.id;
      card.innerHTML = `
        <h3>${staff.name} <small style="color:#94a3b8;font-weight:400;">${staff.title}ï½œ${staff.dept}</small></h3>
        <div class="progress-log">
          <div>ç‹€æ…‹æŒ‡ç¤ºï¼š<span class="badge badge-gray" data-status="${staff.id}">${staff.baseStatus}</span></div>
          <div>ç›®å‰é€²åº¦ï¼š<span data-progress="${staff.id}">å°šæœªæ›´æ–°</span></div>
          <div class="progress-bar"><span data-progress-bar="${staff.id}" style="width:0%"></span></div>
          <div>æœ€å¾Œäº¤è¾¦ï¼š<span data-last-assign="${staff.id}">â€”</span></div>
          <div>æœ€å¾Œå›è¦†ï¼š<span data-last-reply="${staff.id}">â€”</span></div>
        </div>
        <div class="input-stack">
          <label>äº¤è¾¦äº‹é …ï¼š</label>
          <textarea data-assign-input="${staff.id}" placeholder="è¼¸å…¥è¦äº¤ä»£çš„å…§å®¹"></textarea>
          <input type="text" data-progress-input="${staff.id}" placeholder="é€²åº¦ç™¾åˆ†æ¯” 0-100" />
          <button class="mini-btn" data-assign-btn="${staff.id}">å„²å­˜äº¤è¾¦</button>
        </div>
        <div class="input-stack">
          <label>å“¡å·¥å›è¦†ï¼š</label>
          <textarea data-reply-input="${staff.id}" placeholder="ä»£å…¥ ${staff.name} çš„å›è¦† / æœƒå ±å…§å®¹"></textarea>
          <button class="mini-btn" data-reply-btn="${staff.id}">å„²å­˜å›è¦†</button>
        </div>
        <div class="progress-log">
          <strong>äº¤è¾¦ç´€éŒ„ï¼š</strong>
          <ul data-assign-log="${staff.id}" style="margin-left:1rem"></ul>
          <strong>å›è¦†ç´€éŒ„ï¼š</strong>
          <ul data-reply-log="${staff.id}" style="margin-left:1rem"></ul>
        </div>
      `;
      cardsRoot.appendChild(card);
    });

    function storageKey(type, id) {
      return `virtual-dashboard-${type}-${id}`;
    }

    function formatNow() {
      return new Date().toLocaleString('zh-TW');
    }

    function logGlobal(message) {
      const key = 'virtual-dashboard-global-log';
      const logs = JSON.parse(localStorage.getItem(key) || '[]');
      logs.unshift(message);
      localStorage.setItem(key, JSON.stringify(logs.slice(0, 200)));
      renderGlobalLog();
    }

    function renderGlobalLog() {
      const key = 'virtual-dashboard-global-log';
      const logs = JSON.parse(localStorage.getItem(key) || '[]');
      const box = document.getElementById('global-log');
      box.innerHTML = logs.length ? '' : '<p style="color:#94a3b8;">å°šç„¡å°è©±ç´€éŒ„</p>';
      logs.forEach(item => {
        const div = document.createElement('div');
        div.className = 'chat-entry';
        div.innerHTML = `<strong>${item.time}ï½œ${item.target}</strong><br>${item.text}`;
        box.appendChild(div);
      });
    }

    function renderLogs(staffId) {
      const assignLogEl = document.querySelector(`[data-assign-log="${staffId}"]`);
      const replyLogEl = document.querySelector(`[data-reply-log="${staffId}"]`);
      const assignLog = JSON.parse(localStorage.getItem(storageKey('assign', staffId)) || '[]');
      const replyLog = JSON.parse(localStorage.getItem(storageKey('reply', staffId)) || '[]');

      assignLogEl.innerHTML = assignLog.length ? '' : '<li style="color:#94a3b8;">å°šç„¡äº¤è¾¦</li>';
      replyLogEl.innerHTML = replyLog.length ? '' : '<li style="color:#94a3b8;">å°šç„¡å›è¦†</li>';

      assignLog.slice(0, 5).forEach(item => {
        const li = document.createElement('li');
        li.textContent = `${item.time}ï½œ${item.text}ï¼ˆé€²åº¦ ${item.progress}%ï¼‰`;
        assignLogEl.appendChild(li);
      });

      replyLog.slice(0, 5).forEach(item => {
        const li = document.createElement('li');
        li.textContent = `${item.time}ï½œ${item.text}`;
        replyLogEl.appendChild(li);
      });

      const lastAssign = assignLog[0];
      const lastReply = replyLog[0];
      document.querySelector(`[data-last-assign="${staffId}"]`).textContent = lastAssign ? lastAssign.time : 'â€”';
      document.querySelector(`[data-last-reply="${staffId}"]`).textContent = lastReply ? lastReply.time : 'â€”';

      const badge = document.querySelector(`[data-status="${staffId}"]`);
      if (lastAssign && (!lastReply || new Date(lastReply.time) < new Date(lastAssign.time))) {
        badge.className = 'badge badge-yellow';
        badge.textContent = 'å¾…å›è¦†';
      } else if (lastAssign && lastReply) {
        badge.className = 'badge badge-green';
        badge.textContent = 'å·²å›è¦†';
      } else {
        badge.className = 'badge badge-gray';
        badge.textContent = 'å°šæœªäº¤è¾¦';
      }

      const progressEl = document.querySelector(`[data-progress="${staffId}"]`);
      const progressBar = document.querySelector(`[data-progress-bar="${staffId}"]`);
      if (lastAssign) {
        progressEl.textContent = `${lastAssign.progress}%ï½œ${lastAssign.text}`;
        progressBar.style.width = `${Math.min(Math.max(lastAssign.progress, 0), 100)}%`;
      } else {
        progressEl.textContent = 'å°šæœªæ›´æ–°';
        progressBar.style.width = '0%';
      }
    }

    staffList.forEach(staff => {
      const assignBtn = document.querySelector(`[data-assign-btn="${staff.id}"]`);
      const replyBtn = document.querySelector(`[data-reply-btn="${staff.id}"]`);
      const assignInput = document.querySelector(`[data-assign-input="${staff.id}"]`);
      const progressInput = document.querySelector(`[data-progress-input="${staff.id}"]`);
      const replyInput = document.querySelector(`[data-reply-input="${staff.id}"]`);

      assignBtn.addEventListener('click', () => {
        const text = assignInput.value.trim();
        if (!text) return;
        const progress = Number(progressInput.value) || 0;
        const log = JSON.parse(localStorage.getItem(storageKey('assign', staff.id)) || '[]');
        const entry = { time: formatNow(), text, progress: Math.max(0, Math.min(progress, 100)), actor: 'æŒ‡ç¤º' };
        log.unshift(entry);
        localStorage.setItem(storageKey('assign', staff.id), JSON.stringify(log.slice(0, 20)));
        assignInput.value = '';
        progressInput.value = '';
        logGlobal({ time: entry.time, target: `${staff.name}ï¼ˆ${staff.id}ï¼‰`, text: `äº¤è¾¦ï¼š${text}ï½œé€²åº¦ ${entry.progress}%` });
        renderLogs(staff.id);
      });

      replyBtn.addEventListener('click', () => {
        const text = replyInput.value.trim();
        if (!text) return;
        const log = JSON.parse(localStorage.getItem(storageKey('reply', staff.id)) || '[]');
        const entry = { time: formatNow(), text: `${staff.name}ï¼š${text}` };
        log.unshift(entry);
        localStorage.setItem(storageKey('reply', staff.id), JSON.stringify(log.slice(0, 20)));
        replyInput.value = '';
        logGlobal({ time: entry.time, target: `${staff.name}ï¼ˆå›è¦†ï¼‰`, text });
        renderLogs(staff.id);
      });

      renderLogs(staff.id);
    });

    // åœ˜é«”æœƒè­°ä¸‹æ‹‰é¸å–®
    const globalTarget = document.getElementById('global-target');
    globalTarget.innerHTML = '<option value="ALL">å…¨éƒ¨äºº</option>';
    ['ç¾å®¹','ç¶²è·¯è¡ŒéŠ·ä»£æ“','ç¾é‡‘æµ / BTC'].forEach(dept => {
      const opt = document.createElement('option');
      opt.value = `DEPT:${dept}`;
      opt.textContent = `éƒ¨é–€ï¼š${dept}`;
      globalTarget.appendChild(opt);
    });
    staffList.forEach(staff => {
      const opt = document.createElement('option');
      opt.value = staff.id;
      opt.textContent = `${staff.id}ï½œ${staff.name}`;
      globalTarget.appendChild(opt);
    });

    document.getElementById('global-send').addEventListener('click', () => {
      const text = document.getElementById('global-message').value.trim();
      if (!text) return;
      const targetValue = globalTarget.value;
      let label = '';
      if (targetValue === 'ALL') label = 'å…¨éƒ¨äºº';
      else if (targetValue.startsWith('DEPT:')) label = targetValue.replace('DEPT:','éƒ¨é–€ï¼š');
      else {
        const staff = staffList.find(s => s.id === targetValue);
        label = staff ? `${staff.name}ï¼ˆ${staff.id}ï¼‰` : targetValue;
      }
      const entry = { time: formatNow(), target: label, text };
      logGlobal(entry);
      document.getElementById('global-message').value = '';
    });

    renderGlobalLog();
  </script>
</body>
</html>
